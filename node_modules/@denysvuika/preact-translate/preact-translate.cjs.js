"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("preact"),e=require("preact/hooks");function a(t,e){return[t,!t||t.endsWith("/")?"":"/",e,".json"].join("")}function n(t,e){let a=t;return e&&Object.keys(e).forEach((t=>{const n=e[t],r=new RegExp(`{${t}}`,"gm");a=a.replace(r,n.toString())})),a}function r(t,e,a){let n=t[e];if(!n)return a;const r=a.split(".");let o="";do{o+=r.shift();const t=n[o];void 0===t||"object"!=typeof t&&r.length?r.length?o+=".":n=a:(n=t,o="")}while(r.length);return n}let o={};const l={root:"",lang:"en",fallbackLang:"en"};const s=t.createContext(null),c="assets",i="en",g="en";exports.TranslateContext=s,exports.TranslateProvider=u=>{const{t:f,setLang:d,lang:p,isReady:b}=function(t,s){t=Object.assign({},l,t),o=s||o;const[c,i]=e.useState(t.lang),[g,u]=e.useState(o),[f,d]=e.useState(!1),p=e.useCallback((async e=>{if(!g[e]){d(!1);try{const n=a(t.root,e),r=await fetch(n);o[e]=await r.json()}catch(t){console.error(`Failed to load language data for ${e}:`,t)}finally{u({...o}),d(!0)}}}),[g,t.root]);e.useEffect((()=>{(async()=>{await p(t.fallbackLang),await p(c)})()}),[c,p,t.fallbackLang]);const b=e.useMemo((()=>(e,a)=>{if(!g.hasOwnProperty(c))return e;let o=r(g,c,e);return o===e&&c!==t.fallbackLang&&(o=r(g,t.fallbackLang,e)),n(o,a)}),[g,c,t.fallbackLang]);return{lang:c,setLang:i,t:b,isReady:f}}({root:u.root||c,lang:u.lang||i,fallbackLang:u.fallbackLang||g},u.translations);return t.h(s.Provider,{value:{t:f,setLang:d,lang:p,isReady:b}},u.children)},exports.format=n,exports.getResourceUrl=a,exports.getValue=r;
